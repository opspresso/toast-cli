# Toaster 개선사항

## 보안 관련

- [x] SSH StrictHostKeyChecking 설정 변경
  - 문제: `no` 설정으로 인한 MITM 공격 취약점
  - 해결: `accept-new`로 변경하여 보안 강화

- [x] AWS 자격 증명 파일 권한 관리
  - 문제: 백업 파일(.aws/credentials.backup)의 권한이 설정되지 않음
  - 해결: 백업 파일 생성 시 600 권한 설정 추가됨

## 에러 처리

- [ ] AWS CLI 명령어 에러 처리 개선
  - 문제: AWS CLI 명령 실행 결과에 대한 상세한 에러 처리 부족
  - 개선: 각 AWS CLI 명령어에 대한 구체적인 에러 메시지와 처리 로직 추가

- [ ] JSON 파싱 에러 처리
  - 문제: jq 명령어 실행 시 에러 처리 부재
  - 개선: jq 명령어 실행 결과 검증 및 에러 처리 로직 추가

## 환경 변수

- [x] AWS 리전 설정 개선
  - 문제: AWS_REGION만 설정되고 AWS_DEFAULT_REGION은 설정되지 않음
  - 해결: AWS_DEFAULT_REGION도 함께 설정되도록 개선됨

- [ ] 환경 변수 export 처리
  - 문제: 일부 환경 변수가 export 되지 않은 채로 사용됨
  - 개선: 필요한 환경 변수들의 export 처리 추가

## 코드 구조

- [x] Git 관련 함수 리팩토링
  - 문제: git 관련 함수들이 너무 길고 복잡함
  - 해결: git_prepare 함수를 더 작은 단위로 분리하고 각 기능을 모듈화함

- [x] 전역 변수 사용 최소화
  - 문제: 과도한 전역 변수 사용으로 코드 예측 가능성 저하
  - 해결: 지역 변수를 활용하여 변수 범위를 제한하고 함수 간 의존성 감소

## 버전 관리

- [x] 버전 관리 시스템 개선
  - 문제: THIS_VERSION이 하드코딩되어 있음 (v0.0.0)
  - 해결: TOAST_VERSION 환경변수와 VERSION 파일을 활용한 유연한 버전 관리 구현

## 임시 파일 처리

- [x] 임시 파일 관리 개선
  - 문제: 임시 파일이 항상 적절히 정리되지 않음
  - 해결: cleanup 함수와 trap을 사용하여 스크립트 종료 시 모든 임시 파일 자동 정리

- [x] 임시 파일 이름 충돌 방지
  - 문제: 고정된 임시 파일 이름으로 인한 동시 실행 시 충돌 가능성
  - 해결: mktemp를 사용하여 유니크한 임시 파일 이름 자동 생성

## 호환성

- [x] 크로스 플랫폼 명령어 호환성
  - 문제: 일부 명령어의 Linux/macOS 호환성만 고려됨
  - 해결: OS별 래퍼 함수와 자동 의존성 설치를 통한 호환성 확보

## 기능 개선

- [ ] MFA 토큰 검증 로직
  - 문제: MFA 토큰 입력 시 기본적인 검증 부재
  - 개선: 토큰 형식 및 길이 검증 로직 추가

- [ ] 사용자 입력 값 검증
  - 문제: 일부 기능에서 사용자 입력 값 검증 부족
  - 개선: 각 입력 값에 대한 적절한 유효성 검사 추가
